Backbone.GUI=function(a){return a.Component=Backbone.View.extend({initialize:function(a){Backbone.View.prototype.initialize.apply(this,arguments),_.extend(this.options,a);var b=this,c=b.model,d=this.options.property;c&&d&&c.on("change:"+d,function(a,c){b.setVal(c)})},setElement:function(){var a=this.model;Backbone.View.prototype.setElement.apply(this,arguments),this.setVal(a?a.get(this.options.property):0)},setVal:function(){},render:function(){return this.setElement($(this.template)),this}}),a.View=Backbone.View.extend({template:'<div class="bb-gui"></div>',row_template:'<div class="row"><% if (key) { %><span class="label"><%= key %></span><% } %></div>',initialize:function(a){this.gui=a.gui,Backbone.View.prototype.initialize.apply(this,arguments)},render:function(){var a=this.model,b=$(this.template),c=this.gui||{},d=_.template(this.row_template);return _.each(a.attributes,function(e,f){var g=Backbone.GUI,h=typeof e,i=c[f],j=!_.isString(i),k=_.extend({model:a,property:f},j?i:{}),l,m;if(!j||k.component)j?component=k.component:component=i;else switch(h){case"string":component="TextInput";break;case"number":component="HorizontalSlider";break;case"boolean":component="TriggerButton"}c[f]!==null&&(needs_label=["HoldButton","TriggerButton"].indexOf(component)==-1,l=$(d({key:needs_label?f:!1})),m=new Backbone.GUI[component](k),l.append(m.render().el),b.append(l))}),this.setElement(b),this}}),a}({}),Backbone.GUI=function(a){return a.HoldButton=Backbone.GUI.Component.extend({options:{action:!1,label:!1},events:{"mousedown input":"click"},template:'<div class="bb-gui-component"><input type="button" class="button" /></div>',setVal:function(a){this.$input[a?"addClass":"removeClass"]("true")},click:function(a){var b=this.model,c=this.options,d=c.property,e=c.action,f,g;d?(b.set(d,!b.get(d)),$(window).one("mouseup.button",function(){b.set(d,!b.get(d))})):e&&(f=_.isFunction(e)?e:b[e],g=setInterval(f),$(window).one("mouseup.button",function(){clearInterval(g)})),a.preventDefault()},setElement:function(a){var b=this.options,c=b.label,d=b.property,e=this.options.action;this.$input=$("input",a),this.$input.attr("value",c||d||(_.isString(e)?e:"Unknown")),Backbone.GUI.Component.prototype.setElement.apply(this,arguments)}}),a.TriggerButton=a.HoldButton.extend({events:{mousedown:"click"},template:'<div class="bb-gui-component"><input type="button" class="button" /></div>',click:function(a){var b=this.model,c=this.options,d=c.property,e=c.action,f,g;d?b.set(d,!b.get(d)):e&&(f=_.isFunction(e)?e:b[e],f()),a.preventDefault()}}),a}(Backbone.GUI),Backbone.GUI=function(a){return a.RadioButtons=Backbone.GUI.Component.extend({options:{property:!1,options:!1},events:{"click input":"changeInput"},template:'<div class="bb-gui-component"><form class="radio"></form></div>',setVal:function(a){this.$inputs.val([a])},changeInput:function(a){var b=this.$inputs.filter(":checked").val();this.model.set(this.options.property,b)},setElement:function(a){this.$inputs=$("input",a),Backbone.GUI.Component.prototype.setElement.apply(this,arguments)},render:function(){var a=$(this.template),b=this.options.property,c=this.cid,d=$("form",a);return _.each(this.options.options,function(a){d.append('<div class="input"><input type="radio" name="'+c+"-"+b+'" value="'+a+'" /><span>'+a+"</span></div>")}),this.setElement(a),this}}),a.Dropdown=a.RadioButtons.extend({options:{property:!1,options:!1},events:{"change select":"changeInput"},template:'<div class="bb-gui-component"><form class="dropdown"><select></select></form></div>',changeInput:function(a){var b=this.$inputs.val();this.model.set(this.options.property,b)},setElement:function(a){this.$inputs=$("select",a),Backbone.GUI.Component.prototype.setElement.apply(this,arguments)},render:function(){var a=$(this.template),b=this.options.property,c=this,d=$("select",a);return _.each(this.options.options,function(a){d.append('<option value="'+a+'">'+a+"</option>")}),this.setElement(a),this}}),a}(Backbone.GUI),Backbone.GUI=function(a){return a.VerticalSlider=Backbone.GUI.Component.extend({options:{property:!1,min:0,max:100},events:{"mousedown .grip":"startSlide"},template:'<div class="bb-gui-component"><div class="vertical slider"><div class="track"><div class="grip"></div></div></div></div>',setVal:function(a){var b=100,c=this.options.max-this.options.min,d=(a-this.options.min)/c,e=b*d;this.$track.height(e+"%")},startSlide:function(a){$(window).on("mousemove.slider",_.bind(this.onSlide,this)),$(window).one("mouseup",this.stopSlide)},stopSlide:function(){$(window).off("mousemove.slider")},onSlide:function(a){var b=this.model,c=this.options,d=this.$el,e=d.height(),f=d.offset().top,g=f+e,h=g-a.clientY,i=h/e,j=c.max-c.min,k=c.min+j*i,l;k<c.min?l=c.min:k>c.max?l=c.max:l=k,b.set(c.property,l)},setElement:function(a){this.$track=$(".track",a),Backbone.GUI.Component.prototype.setElement.apply(this,arguments)}}),a.HorizontalSlider=a.VerticalSlider.extend({template:'<div class="bb-gui-component"><div class="horizontal slider"><div class="track"><div class="grip"></div></div></div></div>',setVal:function(a){var b=100,c=this.options.max-this.options.min,d=(a-this.options.min)/c,e=b*d;this.$track.width(e+"%")},onSlide:function(a){var b=this.model,c=this.options,d=this.$el,e=d.width(),f=d.offset().left,g=a.clientX-f,h=g/e,i=c.max-c.min,j=c.min+i*h,k;j<c.min?k=c.min:j>c.max?k=c.max:k=j,b.set(c.property,k)}}),a.Knob=a.VerticalSlider.extend({options:_.extend({rotate:120},a.VerticalSlider.prototype.options),template:'<div class="bb-gui-component"><div class="round slider"><div class="track"><div class="grip"></div></div></div></div>',setVal:function(a){var b=this.options.rotate*2,c=this.options.max-this.options.min,d=(a-this.options.min)/c,e=b*d-this.options.rotate;this.$grip.css("-webkit-transform","rotate("+e+"deg)")},setElement:function(a){this.$grip=$(".grip",a),Backbone.GUI.Component.prototype.setElement.apply(this,arguments)}}),a}(Backbone.GUI),Backbone.GUI=function(a){return a.TextInput=Backbone.GUI.Component.extend({options:{property:!1},events:{"submit form":"changeInput"},template:'<div class="bb-gui-component"><form class="text"><input /></form></div>',setVal:function(a){this.$input.val(a)},changeInput:function(a){var b=this.$input.val();this.model.set(this.options.property,b),a.preventDefault()},setElement:function(a){this.$input=$("input",a),Backbone.GUI.Component.prototype.setElement.apply(this,arguments)}}),a}(Backbone.GUI);